@page
@model GasAwareness.UI.Pages.Videos
@{
    ViewData["Title"] = "Videos";
}

<div class="row mt-4">
    @* SOL TARAF: VİDEO LİSTELERİ *@
    <div class="col-md-9">
        
        @* İZLENEN VİDEOLAR - Sadece varsa göster *@
        @if (Model.WatchedVideos != null && Model.WatchedVideos.Any())
        {
            <h4>İzlediğim Videolar</h4>
            <div class="row mb-5">
                @foreach (var video in Model.WatchedVideos)
                {
                    <div class="col-md-4 mt-3">
                        <a class="card h-100 border-0 shadow-sm video-card" href="/VideoDetail/@video.Id">
                            <div class="position-relative overflow-hidden rounded-3">
                                <img src="/files/DefaultThumbnail.png" class="card-img-top" alt="@video.Title">
                                <div class="position-absolute top-50 start-50 translate-middle">
                                    <i class="bi bi-play-circle-fill text-white opacity-75 display-4"></i>
                                </div>
                                <span class="badge bg-dark position-absolute bottom-0 end-0 m-2 opacity-75">
                                    <i class="bi bi-clock"></i> @video.DurationSeconds
                                </span>
                            </div>
                            <div class="card-body px-0">
                                <h5 class="card-title fw-bold text-dark mb-1">@video.Title</h5>
                            </div>
                        </a>
                    </div>
                }
            </div>
            <hr />
        }

        @* TÜM VİDEOLAR *@
        <h4>Tüm Videolar</h4>
        <div class="row">
            @if (!Model.VideoModels.Any())
            {
                <div class="col-12">
                    <h5 class="text-muted">Seçilen kriterlere uygun video bulunamadı.</h5>
                </div>
            }
            else
            {
                @foreach (var video in Model.VideoModels)
                {
                    <div class="col-md-4 mt-3">
                         @* ... (Video Kartı İçeriği - Yukarıdakiyle aynı) ... *@
                         <a class="card h-100 border-0 shadow-sm video-card" href="/VideoDetail/@video.Id">
                            <div class="position-relative overflow-hidden rounded-3">
                                <img src="/files/DefaultThumbnail.png" class="card-img-top" alt="@video.Title">
                                <div class="card-body px-0">
                                    <h5 class="card-title fw-bold text-dark mb-1">@video.Title</h5>
                                </div>
                            </div>
                        </a>
                    </div>
                }
            }
        </div>
    </div>

    @* SAĞ TARAF: FİLTRELER (Artık her zaman görünür) *@
    <div class="col-md-3">
        <div class="sticky-top" style="top: 20px;">
            <h5 class="mb-3">Filtrele</h5>
            <form method="GET">
                <div class="mb-3">
                    <label class="form-label small">Kategori</label>
                    <select asp-for="RequestDto.CategoryId" class="form-select" asp-items="@(new SelectList(Model.Categories, "Id", "Name"))">
                        <option value="">Kategori Seçin</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label small">Yaş Grubu</label>
                    <select asp-for="RequestDto.AgeGroupId" class="form-select">
                        <option value="">Yaş Grubu Seçin</option>
                        @foreach (var ageGroup in Model.AgeGroups)
                        {
                            <option value="@ageGroup.Id">@ageGroup.Name (@ageGroup.MinAge - @ageGroup.MaxAge)</option>
                        }
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label small">Abonelik Tipi</label>
                    <select asp-for="RequestDto.SubscriptionTypeId" class="form-select">
                        <option value="">Abonelik Tipi Seçin</option>
                        @foreach (var type in Model.SubscriptionTypes)
                        {
                            <option value="@type.Id">@type.Name</option>
                        }
                    </select>
                </div>

                <div class="d-grid gap-2">
                    <button type="submit" class="btn btn-primary">Uygula</button>
                    <a asp-page="/Videos" class="btn btn-outline-secondary btn-sm">Sıfırla</a>
                </div>
            </form>
        </div>
    </div>
</div>